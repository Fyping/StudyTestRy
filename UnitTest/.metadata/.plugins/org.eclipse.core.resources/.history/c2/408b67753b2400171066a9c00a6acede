package UnitTest;

import java.util.Collections;
import java.util.List;
import java.util.Arrays;
import java.util.ArrayList;
public class Solution {
    /**
     * @param num: Given the candidate numbers
     * @param target: Given the target number
     * @return: All the combinations that sum to target
     */
    public List<List<Integer>> combinationSum2(int[] num, int target) {
        // write your code here
        
        ArrayList<ArrayList<Integer>> result = new ArrayList<ArrayList<Integer>>();
        Arrays.sort(num);
        int len=num.length;
        for(int i=num.length-1;i>=0;i--){
            if(num[i]>target){
                len--;
            }
        }
      //  System.out.printf("Len= %d",len);
        int tempT=target;
        int tempK = target;
        for(int j=len-1;j>=0;j--){
            tempT=target;
           // tempK=target;
            ArrayList<Integer> temp =  new ArrayList<Integer>();
            ArrayList<Integer> temp_ =  new ArrayList<Integer>();
            int count=0;
            for(int i=j;i>=0;i--){
                if(count%2==0){
	            	if(tempT-num[i]>=0){
	                  tempT-=num[i];
	                  temp.add(num[i]);
	                }
                }else{
                	if(tempK-num[i] >=0){
                		tempK-=num[i];
                		temp_.add(num[i]);
                	}
                }
               if(tempT==0||tempK==0){
            	   if(count%2==0){
	            	   Collections.sort(temp);
	                   result.add(temp);
	                   i=j;
	                   tempT=target;
            	   }else{
	            	   Collections.sort(temp_);
	            	   if(!isTheSame(temp,temp_)){
	               			result.add(temp_);
	               	   }
	                   i=j;
	                   tempT=target;            		  
            	   }
            	   count++;
	               }
               if(count==num.length-1){
            	   break;
               }
            }
            /*for(int k=0;k<=j;k++){
                if(tempK-num[k]>=0){
                    tempK-=num[k];
                    temp_.add(num[k]);
                  }
                 if(tempT==0){
                     break;
                 }
            }*/
            /*if(tempK==0){
            	Collections.sort(temp_);
            	if(!isTheSame(temp,temp_)){
            		result.add(temp_);
            	}
            }*/
            
        }
        /*for(int i=0;i<len;i++){
            System.out.print(num[i] );
        }*/
        for(int i=0;i<result.size();i++){
        	System.out.print("[");
        	for(int j=0;j<result.get(i).size();j++){
        		System.out.print(" ["+ result.get(i).get(j)+"]");
        	}
        	System.out.print(" ] \n");
        }
        return (List)result;
    }
    private boolean isTheSame(ArrayList<Integer> temp, ArrayList<Integer> temp_) {
		// TODO Auto-generated method stub
    	boolean result=true;
    	if(temp.size()!=temp_.size()){
    		return false;
    	}
    	for(int i=0;i<temp.size();i++){
    		if(temp.get(i) !=temp_.get(i)){
    			return false;
    		}
    	}
		return result;
	}
	public static void main(String[] args) {
		Solution a = new Solution();
		int num[] = {7,1,2,5,1,6,10};
		int target=8;
		a.combinationSum2(num, target);
	}
}